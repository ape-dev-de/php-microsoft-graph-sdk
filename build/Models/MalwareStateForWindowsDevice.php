<?php

declare(strict_types=1);

namespace ApeDevDe\MicrosoftGraphSdk\Models;

/**
 * MalwareStateForWindowsDevice
 */
class MalwareStateForWindowsDevice
{
    /** @var array<string, mixed> Raw data from API response */
    private array $rawData = [];

    /** The unique identifier for an entity. Read-only. */
    public ?string $id = null;

    /** Indicates the number of times the malware is detected */
    public ?float $detectionCount = null;

    /** Indicates the name of the device being evaluated for malware state */
    public ?string $deviceName = null;

    /** 
     * Indicates execution status of the malware. Possible values are: unknown, blocked, allowed, running, notRunning. Defaults to unknown. Possible values are: unknown, blocked, allowed, running, notRunning.
     * @var WindowsMalwareExecutionState|\stdClass|null
     */
    public WindowsMalwareExecutionState|\stdClass|null $executionState = null;

    /** Initial detection datetime of the malware */
    public ?\DateTimeInterface $initialDetectionDateTime = null;

    /** The last time this particular threat was changed */
    public ?\DateTimeInterface $lastStateChangeDateTime = null;

    /** 
     * Indicates threat status of the malware. Possible values are: active, actionFailed, manualStepsRequired, fullScanRequired, rebootRequired, remediatedWithNonCriticalFailures, quarantined, removed, cleaned, allowed, noStatusCleared. defaults to noStatusCleared. Possible values are: active, actionFailed, manualStepsRequired, fullScanRequired, rebootRequired, remediatedWithNonCriticalFailures, quarantined, removed, cleaned, allowed, noStatusCleared.
     * @var WindowsMalwareThreatState|\stdClass|null
     */
    public WindowsMalwareThreatState|\stdClass|null $threatState = null;


    /**
     * Constructor - fast deserialization
     * @param array<string, mixed> $data
     */
    public function __construct(array $data = [])
    {
        $this->rawData = $data;
        if (isset($data['id'])) {
            $this->id = $data['id'];
        }
        if (isset($data['detectionCount'])) {
            $this->detectionCount = is_numeric($data['detectionCount']) ? (float)$data['detectionCount'] : $data['detectionCount'];
        }
        if (isset($data['deviceName'])) {
            $this->deviceName = $data['deviceName'];
        }
        if (isset($data['executionState'])) {
            $this->executionState = is_string($data['executionState']) ? WindowsMalwareExecutionState::tryFrom($data['executionState']) : $data['executionState'];
        }
        if (isset($data['initialDetectionDateTime'])) {
            $this->initialDetectionDateTime = is_string($data['initialDetectionDateTime']) ? new \DateTimeImmutable($data['initialDetectionDateTime']) : $data['initialDetectionDateTime'];
        }
        if (isset($data['lastStateChangeDateTime'])) {
            $this->lastStateChangeDateTime = is_string($data['lastStateChangeDateTime']) ? new \DateTimeImmutable($data['lastStateChangeDateTime']) : $data['lastStateChangeDateTime'];
        }
        if (isset($data['threatState'])) {
            $this->threatState = is_string($data['threatState']) ? WindowsMalwareThreatState::tryFrom($data['threatState']) : $data['threatState'];
        }
    }

    /**
     * Get raw data from API response
     * @return array<string, mixed>
     */
    public function getRaw(): array
    {
        return $this->rawData;
    }
}
